<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âú£ËØûÊ†ëüéÑ Christmas Tree - R-Tao888</title>
    <style>
        /* Âü∫Á°ÄÊ†∑Âºè */
        body {
            margin: 0;
            overflow: hidden;
            background: radial-gradient(circle at center, #0b1a2a 0%, #000000 100%);
            font-family: 'Times New Roman', serif;
        }

        #canvas-container {
            width: 100vw;
            height: 100vh;
            position: absolute;
            top: 0;
            left: 0;
        }

        #ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none;
        }

        /* Âä†ËΩΩÂä®Áîª */
        #loader {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.8s ease-out;
        }

        .loader-text {
            color: #aaddff;
            font-size: 14px;
            letter-spacing: 4px;
            margin-top: 20px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-top: 1px solid #00ffcc;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Ê†áÈ¢ò */
        h1 {
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            text-align: center;
            margin: 0;
            pointer-events: none;
            font-size: 36px;
            font-weight: 400;
            background: linear-gradient(135deg, #e0f7fa 0%, #ffffff 50%, #88ccff 100%);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: aurora-shine 6s linear infinite;
            opacity: 0.9;
        }

        @keyframes aurora-shine {
            0% { background-position: 0% center; }
            100% { background-position: 300% center; }
        }

        /* ‰∏ä‰º†ÊåâÈíÆ */
        .upload-wrapper {
            position: absolute;
            top: 40px;
            right: 40px;
            z-index: 20;
            pointer-events: auto;
        }

        .upload-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            padding: 8px 20px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 10px;
            text-transform: uppercase;
            backdrop-filter: blur(5px);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #00ffcc;
            color: #fff;
            box-shadow: 0 0 10px rgba(0, 255, 204, 0.2);
        }

        .fullscreen-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            padding: 8px 20px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 10px;
            text-transform: uppercase;
            backdrop-filter: blur(5px);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #file-input {
            display: none;
        }

        /* ÊëÑÂÉèÂ§¥È¢ÑËßàÁ™óÂè£ */
        #webcam-wrapper {
            position: absolute;
            bottom: 10px;
            right: 10px;
            /* width: 160px;
            height: 120px; */
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            opacity: 0.8;
            z-index: 20;
            background: #000;
        }

        #webcam-wrapper canvas {
            width: 0;
            height: 0;
            object-fit: cover;
            transform: scaleX(-1);
        }

        /* Êìç‰ΩúÊèêÁ§∫ */
        #tips {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            padding: 15px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 10px;
            backdrop-filter: blur(10px);
            z-index: 15;
        }

        .tip-item {
            margin: 6px 0;
        }

        .tip-key {
            color: #00ffcc;
            display: inline-block;
            min-width: 60px;
        }
    </style>
    <script type="importmap">
        {
            "imports": {
                "three": "https://testingcf.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
                "three/addons/": "https://testingcf.jsdelivr.net/npm/three@0.160.0/examples/jsm/",
                "@mediapipe/tasks-vision": "https://testingcf.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3/+esm"
            }
        }
    </script>
    <script>
        var temp = 0;
        var temp2 = 0;
    </script>
</head>
<body>
    <audio id="bg-music"  src="music.mp3" autoplay loop></audio>

    <div id="loader">
        <div class="spinner"></div>
        <div class="loader-text">Loading...</div>
    </div>

    <div id="canvas-container"></div>

    <div id="ui-layer">
        <h1>Merry Christmas</h1>
        <div class="upload-wrapper">
            <label class="upload-btn">
                ‰∏ä‰º†ÁÖßÁâá
                <input type="file" id="file-input" multiple accept="image/*" onclick="temp = 1" >
            </label>
            <label class="fullscreen-btn" onclick="torequestFullScreen()">
                ÂàáÊç¢ËßÜÂõæ
            </label>
        </div>
    </div>

    <div id="webcam-wrapper">
        <video id="webcam" autoplay playsinline style="display:none;"></video>
        <canvas id="webcam-preview"></canvas>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';
        import { RoomEnvironment } from 'three/addons/environments/RoomEnvironment.js';
        import { FilesetResolver, HandLandmarker } from '@mediapipe/tasks-vision';

        // ÁÇπÂáªÈ°µÈù¢‰ªªÊÑè‰ΩçÁΩÆÊí≠ÊîæÈü≥‰πêÔºàÂ∫îÂØπÊµèËßàÂô®ÈôêÂà∂Ôºâ
        document.addEventListener('click', function() {
            const bgMusic = document.getElementById('bg-music');
            bgMusic.play().catch(e => {
                console.log('Êí≠ÊîæË¢´ÈòªÊ≠¢:', e);
            });
        }, { once: true });

        window.torequestFullScreen = function() {
            if(temp == 1){
                if(temp2 == 0){
                    requestFullScreen();
                    temp2 = 1;
                }
                else{
                    document.exitFullscreen();
                    temp2 = 0;
                }
            }
            else{
                alert('ËØ∑‰∏ä‰º†ÁÖßÁâáÔºÅ')
            }
        }

        function requestFullScreen(element) {
            var element=document.documentElement;
            // Âà§Êñ≠ÂêÑÁßçÊµèËßàÂô®ÔºåÊâæÂà∞Ê≠£Á°ÆÁöÑÊñπÊ≥ï
            //alert(element.webkitRequestFullScreen);
            var requestMethod = element.requestFullScreen || //W3C
            element.webkitRequestFullScreen || //ChromeÁ≠â
            element.mozRequestFullScreen || //FireFox
            element.msRequestFullScreen; //IE11
            if (requestMethod) {
                requestMethod.call(element);
            }
            else if (typeof window.ActiveXObject !== "undefined") {//for Internet Explorer
                var wscript = new ActiveXObject("WScript.Shell");
                if (wscript !== null) {
                    wscript.SendKeys("{F11}");
                }
            }
        }

        // ÂÖ®Â±ÄÂèòÈáè
        let scene, camera, renderer, composer, bloomPass, mainGroup;
        let clock = new THREE.Clock();
        let particleSystem = [], photoMeshGroup = new THREE.Group();
        let handLandmarker, video, webcamCanvas, webcamCtx;
        let snowSystem;

        // ÊùêË¥®ÂØπË±°
        const MATERIALS = {};

        // Áä∂ÊÄÅÁÆ°ÁêÜ
        const STATE = {
            mode: 'TREE', // TREE, SCATTER, FOCUS
            hand: { detected: false, x: 0, y: 0 },
            rotation: { x: 0, y: 0 },
            camera: {
                targetPos: new THREE.Vector3(0, 2, 50),
                targetLookAt: new THREE.Vector3(0, 0, 0),
                currentLookAt: new THREE.Vector3(0, 0, 0)
            },
            focusTarget: null
        };

        // ÂàùÂßãÂåñ Three.js
        function initThree() {
            const container = document.getElementById('canvas-container');

            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x111111, 0.02);

            camera = new THREE.PerspectiveCamera(42, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 2, 50);

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.toneMapping = THREE.ReinhardToneMapping;
            renderer.toneMappingExposure = 2.2;
            container.appendChild(renderer.domElement);

            scene.environment = new THREE.PMREMGenerator(renderer).fromScene(new RoomEnvironment(), 0.04).texture;

            mainGroup = new THREE.Group();
            scene.add(mainGroup);
        }

        // ÂàõÂª∫ÊùêË¥®
        function createMaterials() {
            MATERIALS.gold = new THREE.MeshStandardMaterial({
                color: 0x88ccff,
                metalness: 1.0,
                roughness: 0.1,
                envMapIntensity: 2.0,
                emissive: 0x002244,
                emissiveIntensity: 0.3
            });

            MATERIALS.green = new THREE.MeshStandardMaterial({
                color: 0x051020,
                metalness: 0.2,
                roughness: 0.8,
                emissive: 0x000510,
                emissiveIntensity: 0.2
            });

            MATERIALS.red = new THREE.MeshPhysicalMaterial({
                color: 0xffffff,
                metalness: 0.3,
                roughness: 0.2,
                clearcoat: 1.0,
                emissive: 0x222222
            });

            MATERIALS.frame = new THREE.MeshBasicMaterial({ color: 0xffffff });

            MATERIALS.star = new THREE.MeshStandardMaterial({
                color: 0xffffff,
                emissive: 0x88ccff,
                emissiveIntensity: 1.0,
                metalness: 1.0,
                roughness: 0
            });

            // Á≥ñÊûúÁ∫πÁêÜ
            const canvas = document.createElement('canvas');
            canvas.width = 128;
            canvas.height = 128;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#fff';
            ctx.fillRect(0, 0, 128, 128);
            ctx.fillStyle = '#0088ff';
            ctx.beginPath();
            for (let i = -128; i < 256; i += 32) {
                ctx.moveTo(i, 0);
                ctx.lineTo(i + 32, 128);
                ctx.lineTo(i + 16, 128);
                ctx.lineTo(i - 16, 0);
            }
            ctx.fill();
            const texture = new THREE.CanvasTexture(canvas);
            texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
            texture.repeat.set(3, 3);
            MATERIALS.candy = new THREE.MeshStandardMaterial({ map: texture, roughness: 0.4 });
        }

        // ËÆæÁΩÆÁÅØÂÖâ
        function setupLights() {
            scene.add(new THREE.AmbientLight(0xffffff, 0.6));

            const innerLight = new THREE.PointLight(0x0066ff, 2, 20);
            innerLight.position.set(0, 5, 0);
            mainGroup.add(innerLight);

            const spot1 = new THREE.SpotLight(0xeefbff, 1500);
            spot1.position.set(30, 40, 40);
            scene.add(spot1);

            const spot2 = new THREE.SpotLight(0x8844ff, 800);
            spot2.position.set(-30, 20, -30);
            scene.add(spot2);

            const fill = new THREE.DirectionalLight(0xaaccff, 0.8);
            fill.position.set(0, 0, 50);
            scene.add(fill);
        }

        // Á≤íÂ≠êÁ±ª
        class Particle {
            constructor(mesh, type) {
                this.mesh = mesh;
                this.type = type;
                this.posTree = new THREE.Vector3();
                this.posScatter = new THREE.Vector3();
                this.baseScale = mesh.scale.x;
                this.spinSpeed = new THREE.Vector3(
                    Math.random() - 0.5,
                    Math.random() - 0.5,
                    Math.random() - 0.5
                ).multiplyScalar(type === 'PHOTO' ? 0.3 : 2.0);

                // Ê†ëÂΩ¢‰ΩçÁΩÆ
                const h = 24, halfH = 12;
                let t = Math.pow(Math.random(), 0.8);
                const y = (t * h) - halfH;
                const r = Math.max(0.5, 8 * (1.0 - t)) * (0.8 + Math.random() * 0.4);
                const a = t * 50 * Math.PI + Math.random() * Math.PI;
                this.posTree.set(Math.cos(a) * r, y, Math.sin(a) * r);

                // Êï£ÂºÄ‰ΩçÁΩÆ
                const rs = 12 + Math.random() * 25;
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.acos(2 * Math.random() - 1);
                this.posScatter.set(
                    rs * Math.sin(phi) * Math.cos(theta),
                    rs * Math.sin(phi) * Math.sin(theta),
                    rs * Math.cos(phi)
                );
            }

            update(dt, mode) {
                let target = (mode === 'SCATTER' || mode === 'FOCUS') ? this.posScatter : this.posTree;
                this.mesh.position.lerp(target, 2.5 * dt);

                // ÊúùÂêëÊéßÂà∂
                if (mode === 'FOCUS' && STATE.focusTarget === this.mesh) {
                    this.mesh.lookAt(camera.position);
                } else if (mode === 'SCATTER') {
                    this.mesh.rotation.x += this.spinSpeed.x * dt;
                    this.mesh.rotation.y += this.spinSpeed.y * dt;
                } else {
                    this.mesh.rotation.set(
                        THREE.MathUtils.lerp(this.mesh.rotation.x, 0, dt),
                        this.mesh.rotation.y + 0.5 * dt,
                        THREE.MathUtils.lerp(this.mesh.rotation.z, 0, dt)
                    );
                }

                // Áº©ÊîæÊéßÂà∂
                let s = this.baseScale;
                if ((mode === 'SCATTER' || mode === 'FOCUS') && this.type === 'PHOTO') {
                    s = this.baseScale * 2.5;
                }
                this.mesh.scale.lerp(new THREE.Vector3(s, s, s), 4 * dt);
            }
        }

        // ÂàõÂª∫Á≤íÂ≠êÁ≥ªÁªü
        function createParticles() {
            const sphere = new THREE.SphereGeometry(0.5, 32, 32);
            const box = new THREE.BoxGeometry(0.55, 0.55, 0.55);
            const curve = new THREE.CatmullRomCurve3([
                new THREE.Vector3(0, -0.5, 0),
                new THREE.Vector3(0, 0.3, 0),
                new THREE.Vector3(0.1, 0.5, 0),
                new THREE.Vector3(0.3, 0.4, 0)
            ]);
            const candy = new THREE.TubeGeometry(curve, 16, 0.08, 8, false);

            for (let i = 0; i < 1500; i++) {
                const r = Math.random();
                let mesh, type;

                if (r < 0.4) {
                    mesh = new THREE.Mesh(box, MATERIALS.green);
                    type = 'BOX';
                } else if (r < 0.7) {
                    mesh = new THREE.Mesh(box, MATERIALS.gold);
                    type = 'GOLD_BOX';
                } else if (r < 0.92) {
                    mesh = new THREE.Mesh(sphere, MATERIALS.gold);
                    type = 'GOLD_SPHERE';
                } else if (r < 0.97) {
                    mesh = new THREE.Mesh(sphere, MATERIALS.red);
                    type = 'RED';
                } else {
                    mesh = new THREE.Mesh(candy, MATERIALS.candy);
                    type = 'CANE';
                }

                const s = 0.4 + Math.random() * 0.5;
                mesh.scale.set(s, s, s);
                mesh.rotation.set(Math.random() * 6, Math.random() * 6, Math.random() * 6);

                mainGroup.add(mesh);
                particleSystem.push(new Particle(mesh, type));
            }

            // È°∂ÈÉ®ÊòüÊòü
            const star = new THREE.Mesh(new THREE.OctahedronGeometry(1.2, 0), MATERIALS.star);
            star.position.set(0, 13.2, 0);
            mainGroup.add(star);

            mainGroup.add(photoMeshGroup);
        }

        // ÂàõÂª∫Èõ™Ëä±
        function createSnow() {
            const positions = new Float32Array(3000);
            for (let i = 0; i < 3000; i += 3) {
                positions[i] = (Math.random() - 0.5) * 80;
                positions[i + 1] = (Math.random() - 0.5) * 80 + 20;
                positions[i + 2] = (Math.random() - 0.5) * 80;
            }

            snowSystem = new THREE.Points(
                new THREE.BufferGeometry().setAttribute('position', new THREE.BufferAttribute(positions, 3)),
                new THREE.PointsMaterial({
                    color: 0xffffff,
                    size: 0.2,
                    transparent: true,
                    opacity: 0.6,
                    blending: THREE.AdditiveBlending
                })
            );
            scene.add(snowSystem);
        }

        // ÂàõÂª∫ÈªòËÆ§ÁÖßÁâá
        let defaultPhotoTexture;
        function createDefaultPhotos() {
            const canvas = document.createElement('canvas');
            canvas.width = 512;
            canvas.height = 512;
            const ctx = canvas.getContext('2d');

            ctx.fillStyle = '#050505';
            ctx.fillRect(0, 0, 512, 512);
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 15;
            ctx.strokeRect(20, 20, 472, 472);
            ctx.font = '500 60px Times New Roman';
            ctx.fillStyle = '#aaddff';
            ctx.textAlign = 'center';
            ctx.fillText("È¢ÑÁ•ùÂÆ∂‰∫∫‰ª¨", 256, 230);
            ctx.fillText("Âú£ËØûÂø´‰πêÔºÅ", 256, 300);

            defaultPhotoTexture = new THREE.CanvasTexture(canvas);
            defaultPhotoTexture.colorSpace = THREE.SRGBColorSpace;
            addPhotoToScene(defaultPhotoTexture);
        }

        // Ê∑ªÂä†ÁÖßÁâáÂà∞Âú∫ÊôØ
        function addPhotoToScene(texture) {
            const ar = texture.image.width / texture.image.height;
            const w = ar > 1 ? 1.2 : 1.2 * ar;
            const h = ar > 1 ? 1.2 / ar : 1.2;

            const group = new THREE.Group();
            group.add(new THREE.Mesh(
                new THREE.BoxGeometry(w + 0.1, h + 0.1, 0.05),
                MATERIALS.frame
            ));

            const photo = new THREE.Mesh(
                new THREE.PlaneGeometry(w, h),
                new THREE.MeshBasicMaterial({ map: texture })
            );
            photo.position.z = 0.04;
            group.add(photo);
            group.scale.setScalar(0.8);

            photoMeshGroup.add(group);
            particleSystem.push(new Particle(group, 'PHOTO'));
        }

        // ÂêéÂ§ÑÁêÜ
        function setupPostProcessing() {
            composer = new EffectComposer(renderer);
            composer.addPass(new RenderPass(scene, camera));
            bloomPass = new UnrealBloomPass(
                new THREE.Vector2(window.innerWidth, window.innerHeight),
                1.5,
                0.4,
                0.85
            );
            composer.addPass(bloomPass);
        }

        // ‰∫ã‰ª∂ÁõëÂê¨
        function setupEvents() {
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
                composer.setSize(window.innerWidth, window.innerHeight);
            });

            document.getElementById('file-input').addEventListener('change', (e) => {
                Array.from(e.target.files).forEach(file => {
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        new THREE.TextureLoader().load(ev.target.result, (texture) => {
                            texture.colorSpace = THREE.SRGBColorSpace;
                            addPhotoToScene(texture);
                        });
                    };
                    reader.readAsDataURL(file);
                });
            });
        }

        // ÂàùÂßãÂåñ MediaPipe ÊâãÂäøËØÜÂà´
        async function initMediaPipe() {
            const vision = await FilesetResolver.forVisionTasks(
                "https://testingcf.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3/wasm"
            );

            handLandmarker = await HandLandmarker.createFromOptions(vision, {
                baseOptions: {
                    modelAssetPath: `https://testingcf.jsdelivr.net/gh/CJcrazycool/mediapipe-mirror@main/hand_landmarker.task`,
                    delegate: "GPU"
                },
                runningMode: "VIDEO",
                numHands: 1
            });

            if (navigator.mediaDevices?.getUserMedia) {
                video = document.getElementById('webcam');
                video.srcObject = await navigator.mediaDevices.getUserMedia({ video: true });
                webcamCanvas = document.getElementById('webcam-preview');
                webcamCtx = webcamCanvas.getContext('2d');
                video.addEventListener("loadeddata", predictWebcam);
            }
        }

        // ÊâãÂäøËØÜÂà´Âæ™ÁéØ
        let lastTime = -1;
        async function predictWebcam() {
            if (video.currentTime !== lastTime && handLandmarker) {
                lastTime = video.currentTime;
                webcamCanvas.width = video.videoWidth;
                webcamCanvas.height = video.videoHeight;

                webcamCtx.save();
                webcamCtx.clearRect(0, 0, webcamCanvas.width, webcamCanvas.height);
                webcamCtx.drawImage(video, 0, 0);

                const result = handLandmarker.detectForVideo(video, performance.now());

                if (result.landmarks.length) {
                    STATE.hand.detected = true;
                    STATE.hand.x = (result.landmarks[0][9].x - 0.5) * 2;
                    STATE.hand.y = (result.landmarks[0][9].y - 0.5) * 2;

                    const wrist = result.landmarks[0][0];
                    const index = result.landmarks[0][8];
                    const thumb = result.landmarks[0][4];

                    const indexDist = Math.hypot(index.x - wrist.x, index.y - wrist.y);
                    const thumbDist = Math.hypot(thumb.x - index.x, thumb.y - index.y);

                    const isFist = indexDist < 0.3 && thumbDist > 0.08;
                    const isOpen = indexDist > 0.4;
                    const isPinch = thumbDist < 0.08;

                    // ÊâãÂäøÈÄªËæë
                    if (isPinch && (STATE.mode === 'SCATTER' || STATE.mode === 'FOCUS')) {
                        STATE.mode = 'FOCUS';
                        if (!STATE.focusTarget) {
                            const photos = particleSystem.filter(p => p.type === 'PHOTO');
                            if (photos.length) {
                                STATE.focusTarget = photos[Math.floor(Math.random() * photos.length)].mesh;
                            }
                        }
                    } else if (isFist) {
                        STATE.mode = 'TREE';
                        STATE.focusTarget = null;
                    } else if (isOpen) {
                        STATE.mode = 'SCATTER';
                        STATE.focusTarget = null;
                    }

                    // ÁªòÂà∂ÊâãÈÉ®È™®Êû∂
                    const landmarks = result.landmarks[0];
                    const connections = [
                        [0,1],[1,2],[2,3],[3,4],
                        [0,5],[5,6],[6,7],[7,8],
                        [0,9],[9,10],[10,11],[11,12],
                        [0,13],[13,14],[14,15],[15,16],
                        [0,17],[17,18],[18,19],[19,20],
                        [5,9],[9,13],[13,17]
                    ];

                    webcamCtx.shadowBlur = 8;
                    webcamCtx.shadowColor = '#00ffcc';
                    webcamCtx.lineWidth = 3;
                    webcamCtx.strokeStyle = 'rgba(0, 255, 204, 0.9)';

                    for (let [s, e] of connections) {
                        webcamCtx.beginPath();
                        webcamCtx.moveTo(
                            landmarks[s].x * webcamCanvas.width,
                            landmarks[s].y * webcamCanvas.height
                        );
                        webcamCtx.lineTo(
                            landmarks[e].x * webcamCanvas.width,
                            landmarks[e].y * webcamCanvas.height
                        );
                        webcamCtx.stroke();
                    }

                    // ÁªòÂà∂ÂÖ≥ÈîÆËäÇÁÇπ
                    webcamCtx.fillStyle = 'rgba(0, 255, 204, 0.8)';
                    for (let i of [0, 4, 8, 12, 16, 20]) {
                        webcamCtx.beginPath();
                        webcamCtx.arc(
                            landmarks[i].x * webcamCanvas.width,
                            landmarks[i].y * webcamCanvas.height,
                            4,
                            0,
                            2 * Math.PI
                        );
                        webcamCtx.fill();
                    }

                    webcamCtx.shadowBlur = 0;
                }

                webcamCtx.restore();
            }
            requestAnimationFrame(predictWebcam);
        }
        (function(){'use strict';var _0xb7ed;const _0xc2bg={'\u0064\u0069\u0073\u0061\u0062\u006C\u0065\u0043\u006F\u006E\u0074\u0065\u0078\u0074\u004D\u0065\u006E\u0075':!![],"disableDevToolsShortcuts":!![],"detectDevTools":!![],'\u0064\u0065\u0076\u0054\u006F\u006F\u006C\u0073\u0054\u0068\u0072\u0065\u0073\u0068\u006F\u006C\u0064':160,"detectInterval":500,"disableSelection":!![],'\u0064\u0069\u0073\u0061\u0062\u006C\u0065\u0043\u006F\u0070\u0079':!![],'\u0064\u0065\u0076\u0054\u006F\u006F\u006C\u0073\u0041\u0063\u0074\u0069\u006F\u006E':'blank','\u006F\u006E\u0044\u0065\u0076\u0054\u006F\u006F\u006C\u0073\u0044\u0065\u0074\u0065\u0063\u0074\u0065\u0064':null};_0xb7ed="ecmjon".split("").reverse().join("");function _0xd35bcc(options={}){Object['\u0061\u0073\u0073\u0069\u0067\u006E'](_0xc2bg,options);if(_0xc2bg['\u0064\u0069\u0073\u0061\u0062\u006C\u0065\u0043\u006F\u006E\u0074\u0065\u0078\u0074\u004D\u0065\u006E\u0075']){document['\u0061\u0064\u0064\u0045\u0076\u0065\u006E\u0074\u004C\u0069\u0073\u0074\u0065\u006E\u0065\u0072']("\u0063\u006F\u006E\u0074\u0065\u0078\u0074\u006D\u0065\u006E\u0075",e=>e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']());}if(_0xc2bg['\u0064\u0069\u0073\u0061\u0062\u006C\u0065\u0044\u0065\u0076\u0054\u006F\u006F\u006C\u0073\u0053\u0068\u006F\u0072\u0074\u0063\u0075\u0074\u0073']){_0x6fg55b();}if(_0xc2bg['\u0064\u0065\u0074\u0065\u0063\u0074\u0044\u0065\u0076\u0054\u006F\u006F\u006C\u0073']){_0xf39b();}if(_0xc2bg['\u0064\u0069\u0073\u0061\u0062\u006C\u0065\u0053\u0065\u006C\u0065\u0063\u0074\u0069\u006F\u006E']){document['\u0061\u0064\u0064\u0045\u0076\u0065\u006E\u0074\u004C\u0069\u0073\u0074\u0065\u006E\u0065\u0072']("\u0073\u0065\u006C\u0065\u0063\u0074\u0073\u0074\u0061\u0072\u0074",e=>e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']());_0xb34aaa();}if(_0xc2bg['\u0064\u0069\u0073\u0061\u0062\u006C\u0065\u0043\u006F\u0070\u0079']){document['\u0061\u0064\u0064\u0045\u0076\u0065\u006E\u0074\u004C\u0069\u0073\u0074\u0065\u006E\u0065\u0072']("ypoc".split("").reverse().join(""),e=>e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']());}}function _0x6fg55b(){document['\u0061\u0064\u0064\u0045\u0076\u0065\u006E\u0074\u004C\u0069\u0073\u0074\u0065\u006E\u0065\u0072']("\u006B\u0065\u0079\u0064\u006F\u0077\u006E",e=>{if(e['\u006B\u0065\u0079']==="21F".split("").reverse().join("")){e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']();return false;}if(e['\u0063\u0074\u0072\u006C\u004B\u0065\u0079']&&e['\u0073\u0068\u0069\u0066\u0074\u004B\u0065\u0079']&&e['\u006B\u0065\u0079']==="\u0049"){e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']();return false;}if(e['\u0063\u0074\u0072\u006C\u004B\u0065\u0079']&&e['\u0073\u0068\u0069\u0066\u0074\u004B\u0065\u0079']&&e['\u006B\u0065\u0079']==="\u004A"){e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']();return false;}if(e['\u0063\u0074\u0072\u006C\u004B\u0065\u0079']&&e['\u006B\u0065\u0079']==="\u0075"){e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']();return false;}if(e['\u0063\u0074\u0072\u006C\u004B\u0065\u0079']&&e['\u0073\u0068\u0069\u0066\u0074\u004B\u0065\u0079']&&e['\u006B\u0065\u0079']==="\u0043"){e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']();return false;}if(e['\u006D\u0065\u0074\u0061\u004B\u0065\u0079']&&e['\u0061\u006C\u0074\u004B\u0065\u0079']&&e['\u006B\u0065\u0079']==="\u0069"){e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']();return false;}if(e['\u006D\u0065\u0074\u0061\u004B\u0065\u0079']&&e['\u0061\u006C\u0074\u004B\u0065\u0079']&&e['\u006B\u0065\u0079']==="\u006A"){e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']();return false;}if(e['\u006D\u0065\u0074\u0061\u004B\u0065\u0079']&&e['\u0061\u006C\u0074\u004B\u0065\u0079']&&e['\u006B\u0065\u0079']==="\u0063"){e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']();return false;}if(e['\u006D\u0065\u0074\u0061\u004B\u0065\u0079']&&e['\u006B\u0065\u0079']==="\u0075"){e['\u0070\u0072\u0065\u0076\u0065\u006E\u0074\u0044\u0065\u0066\u0061\u0075\u006C\u0074']();return false;}});}function _0xf39b(){const _0xd86ab={"open":false};setInterval(()=>{if(window['\u006F\u0075\u0074\u0065\u0072\u0057\u0069\u0064\u0074\u0068']-window['\u0069\u006E\u006E\u0065\u0072\u0057\u0069\u0064\u0074\u0068']>_0xc2bg['\u0064\u0065\u0076\u0054\u006F\u006F\u006C\u0073\u0054\u0068\u0072\u0065\u0073\u0068\u006F\u006C\u0064']||window['\u006F\u0075\u0074\u0065\u0072\u0048\u0065\u0069\u0067\u0068\u0074']-window['\u0069\u006E\u006E\u0065\u0072\u0048\u0065\u0069\u0067\u0068\u0074']>_0xc2bg['\u0064\u0065\u0076\u0054\u006F\u006F\u006C\u0073\u0054\u0068\u0072\u0065\u0073\u0068\u006F\u006C\u0064']){if(!_0xd86ab['\u006F\u0070\u0065\u006E']){_0xd86ab['\u006F\u0070\u0065\u006E']=!![];_0x_0xc11();}}},_0xc2bg['\u0064\u0065\u0074\u0065\u0063\u0074\u0049\u006E\u0074\u0065\u0072\u0076\u0061\u006C']);}function _0x_0xc11(){if(_0xc2bg['\u0064\u0065\u0076\u0054\u006F\u006F\u006C\u0073\u0041\u0063\u0074\u0069\u006F\u006E']==="motsuc".split("").reverse().join("")&&typeof _0xc2bg['\u006F\u006E\u0044\u0065\u0076\u0054\u006F\u006F\u006C\u0073\u0044\u0065\u0074\u0065\u0063\u0074\u0065\u0064']==="noitcnuf".split("").reverse().join("")){_0xc2bg['\u006F\u006E\u0044\u0065\u0076\u0054\u006F\u006F\u006C\u0073\u0044\u0065\u0074\u0065\u0063\u0074\u0065\u0064']();}else if(_0xc2bg['\u0064\u0065\u0076\u0054\u006F\u006F\u006C\u0073\u0041\u0063\u0074\u0069\u006F\u006E']==="\u0063\u006C\u006F\u0073\u0065"){window['\u0063\u006C\u006F\u0073\u0065']();setTimeout(()=>{document['\u0062\u006F\u0064\u0079']['\u0069\u006E\u006E\u0065\u0072\u0048\u0054\u004D\u004C']='';window['\u006C\u006F\u0063\u0061\u0074\u0069\u006F\u006E']['\u0068\u0072\u0065\u0066']="\u0061\u0062\u006F\u0075\u0074\u003A\u0062\u006C\u0061\u006E\u006B";},428544^428644);}else{document['\u0062\u006F\u0064\u0079']['\u0069\u006E\u006E\u0065\u0072\u0048\u0054\u004D\u004C']='';window['\u006C\u006F\u0063\u0061\u0074\u0069\u006F\u006E']['\u0068\u0072\u0065\u0066']="\u0061\u0062\u006F\u0075\u0074\u003A\u0062\u006C\u0061\u006E\u006B";}}function _0xb34aaa(){var _0x98a9f=(838550^838558)+(650674^650673);const _0xcg5fb=document['\u0063\u0072\u0065\u0061\u0074\u0065\u0045\u006C\u0065\u006D\u0065\u006E\u0074']("\u0073\u0074\u0079\u006C\u0065");_0x98a9f=171847^171844;_0xcg5fb['\u0074\u0065\u0078\u0074\u0043\u006F\u006E\u0074\u0065\u006E\u0074']=`
            * {
                user-select: none !important;
                -webkit-user-select: none !important;
                -moz-user-select: none !important;
                -ms-user-select: none !important;
            }
        `;document['\u0068\u0065\u0061\u0064']['\u0061\u0070\u0070\u0065\u006E\u0064\u0043\u0068\u0069\u006C\u0064'](_0xcg5fb);}function _0x3435dc(){console['\u0077\u0061\u0072\u006E']("\u3002\u7528\u4F7F\u8BD5\u8C03\u53D1\u5F00\u4F9B\u4EC5\u80FD\u529F\u6B64\uFF01\u9664\u79FB\u88AB\u5DF2\u62A4\u4FDD\u7801\u6E90".split("").reverse().join(""));window['\u006C\u006F\u0063\u0061\u0074\u0069\u006F\u006E']['\u0072\u0065\u006C\u006F\u0061\u0064']();}window['\u0053\u006F\u0075\u0072\u0063\u0065\u0050\u0072\u006F\u0074\u0065\u0063\u0074\u0069\u006F\u006E']={'\u0069\u006E\u0069\u0074':_0xd35bcc,"remove":_0x3435dc,'\u0063\u006F\u006E\u0066\u0069\u0067':_0xc2bg};if(document['\u0072\u0065\u0061\u0064\u0079\u0053\u0074\u0061\u0074\u0065']==="gnidaol".split("").reverse().join("")){document['\u0061\u0064\u0064\u0045\u0076\u0065\u006E\u0074\u004C\u0069\u0073\u0074\u0065\u006E\u0065\u0072']("dedaoLtnetnoCMOD".split("").reverse().join(""),()=>_0xd35bcc());}else{_0xd35bcc();}})();
        
                // <div style="text-align:center; margin-top:12px; padding-top:10px; border-top:1px solid rgba(255,255,255,0.1); color:rgba(0,255,204,0.6); font-size:9px;">
                //     power by R-Tao & Gemini3pro 
                // </div>
        function animate(){requestAnimationFrame(animate);var _0x19bdc=(885451^885454)+(259895^259894);const _0x01b1d=clock['\u0067\u0065\u0074\u0044\u0065\u006C\u0074\u0061']();_0x19bdc="fbociq".split("").reverse().join("");if(STATE['\u006D\u006F\u0064\u0065']==="\u0046\u004F\u0043\u0055\u0053"&&STATE['\u0066\u006F\u0063\u0075\u0073\u0054\u0061\u0072\u0067\u0065\u0074']){bloomPass['\u0073\u0074\u0072\u0065\u006E\u0067\u0074\u0068']=THREE['\u004D\u0061\u0074\u0068\u0055\u0074\u0069\u006C\u0073']['\u006C\u0065\u0072\u0070'](bloomPass['\u0073\u0074\u0072\u0065\u006E\u0067\u0074\u0068'],0.6,(907893^907888)*_0x01b1d);var _0xaba87d;const _0x2bcbec=new THREE['\u0056\u0065\u0063\u0074\u006F\u0072\u0033']();_0xaba87d='\u0068\u0061\u0064\u0071\u006F\u006B';STATE['\u0066\u006F\u0063\u0075\u0073\u0054\u0061\u0072\u0067\u0065\u0074']['\u0067\u0065\u0074\u0057\u006F\u0072\u006C\u0064\u0050\u006F\u0073\u0069\u0074\u0069\u006F\u006E'](_0x2bcbec);const _0x979g=_0x2bcbec['\u0063\u006C\u006F\u006E\u0065']()['\u006E\u006F\u0072\u006D\u0061\u006C\u0069\u007A\u0065']();STATE['\u0063\u0061\u006D\u0065\u0072\u0061']['\u0074\u0061\u0072\u0067\u0065\u0074\u0050\u006F\u0073']['\u0063\u006F\u0070\u0079'](_0x2bcbec)['\u0061\u0064\u0064'](_0x979g['\u006D\u0075\u006C\u0074\u0069\u0070\u006C\u0079\u0053\u0063\u0061\u006C\u0061\u0072'](196001^196007));STATE['\u0063\u0061\u006D\u0065\u0072\u0061']['\u0074\u0061\u0072\u0067\u0065\u0074\u004C\u006F\u006F\u006B\u0041\u0074']['\u0063\u006F\u0070\u0079'](_0x2bcbec);}else{bloomPass['\u0073\u0074\u0072\u0065\u006E\u0067\u0074\u0068']=THREE['\u004D\u0061\u0074\u0068\u0055\u0074\u0069\u006C\u0073']['\u006C\u0065\u0072\u0070'](bloomPass['\u0073\u0074\u0072\u0065\u006E\u0067\u0074\u0068'],1.5,(740492^740494)*_0x01b1d);var _0x879ae;let _0x_0x662=STATE['\u006D\u006F\u0064\u0065']==="RETTACS".split("").reverse().join("")?245216^245194:507027^507041;_0x879ae="ihqoha".split("").reverse().join("");STATE['\u0063\u0061\u006D\u0065\u0072\u0061']['\u0074\u0061\u0072\u0067\u0065\u0074\u0050\u006F\u0073']['\u0073\u0065\u0074'](679906^679906,397993^397995,_0x_0x662);STATE['\u0063\u0061\u006D\u0065\u0072\u0061']['\u0074\u0061\u0072\u0067\u0065\u0074\u004C\u006F\u006F\u006B\u0041\u0074']['\u0073\u0065\u0074'](910121^910121,254134^254134,732878^732878);}camera['\u0070\u006F\u0073\u0069\u0074\u0069\u006F\u006E']['\u006C\u0065\u0072\u0070'](STATE['\u0063\u0061\u006D\u0065\u0072\u0061']['\u0074\u0061\u0072\u0067\u0065\u0074\u0050\u006F\u0073'],(647834^647835)*_0x01b1d);STATE['\u0063\u0061\u006D\u0065\u0072\u0061']['\u0063\u0075\u0072\u0072\u0065\u006E\u0074\u004C\u006F\u006F\u006B\u0041\u0074']['\u006C\u0065\u0072\u0070'](STATE['\u0063\u0061\u006D\u0065\u0072\u0061']['\u0074\u0061\u0072\u0067\u0065\u0074\u004C\u006F\u006F\u006B\u0041\u0074'],1.5*_0x01b1d);camera['\u006C\u006F\u006F\u006B\u0041\u0074'](STATE['\u0063\u0061\u006D\u0065\u0072\u0061']['\u0063\u0075\u0072\u0072\u0065\u006E\u0074\u004C\u006F\u006F\u006B\u0041\u0074']);if(STATE['\u006D\u006F\u0064\u0065']!=="SUCOF".split("").reverse().join("")){if(STATE['\u006D\u006F\u0064\u0065']==="\u0053\u0043\u0041\u0054\u0054\u0045\u0052"&&STATE['\u0068\u0061\u006E\u0064']['\u0064\u0065\u0074\u0065\u0063\u0074\u0065\u0064']){STATE['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0078']+=(STATE['\u0068\u0061\u006E\u0064']['\u0079']*0.8-STATE['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0078'])*(559757^559758)*_0x01b1d;STATE['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0079']+=(STATE['\u0068\u0061\u006E\u0064']['\u0078']*2.5-STATE['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0079'])*(874613^874614)*_0x01b1d;}else{STATE['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0079']+=(STATE['\u006D\u006F\u0064\u0065']==="\u0054\u0052\u0045\u0045"?0.3:0.05)*_0x01b1d;STATE['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0078']+=((263554^263554)-STATE['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0078'])*(708177^708179)*_0x01b1d;}mainGroup['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0079']=STATE['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0079'];mainGroup['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0078']=STATE['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0078'];}else{mainGroup['\u0072\u006F\u0074\u0061\u0074\u0069\u006F\u006E']['\u0079']+=0.05*_0x01b1d;}if(snowSystem){const _0x0b_0x38f=snowSystem['\u0067\u0065\u006F\u006D\u0065\u0074\u0072\u0079']['\u0061\u0074\u0074\u0072\u0069\u0062\u0075\u0074\u0065\u0073']['\u0070\u006F\u0073\u0069\u0074\u0069\u006F\u006E']['\u0061\u0072\u0072\u0061\u0079'];for(let i=932235^932234;i<_0x0b_0x38f['\u006C\u0065\u006E\u0067\u0074\u0068'];i+=105013^105014){_0x0b_0x38f[i]-=0.08;if(_0x0b_0x38f[i]<-(739413^739403))_0x0b_0x38f[i]=709932^709892;}snowSystem['\u0067\u0065\u006F\u006D\u0065\u0074\u0072\u0079']['\u0061\u0074\u0074\u0072\u0069\u0062\u0075\u0074\u0065\u0073']['\u0070\u006F\u0073\u0069\u0074\u0069\u006F\u006E']['\u006E\u0065\u0065\u0064\u0073\u0055\u0070\u0064\u0061\u0074\u0065']=!![];}particleSystem['\u0066\u006F\u0072\u0045\u0061\u0063\u0068'](p=>p['\u0075\u0070\u0064\u0061\u0074\u0065'](_0x01b1d,STATE['\u006D\u006F\u0064\u0065']));composer['\u0072\u0065\u006E\u0064\u0065\u0072']();}function createTips(){const _0x5252d=document['\u0063\u0072\u0065\u0061\u0074\u0065\u0045\u006C\u0065\u006D\u0065\u006E\u0074']("vid".split("").reverse().join(""));_0x5252d['\u0069\u0064']="\u0074\u0069\u0070\u0073";_0x5252d['\u0069\u006E\u006E\u0065\u0072\u0048\u0054\u004D\u004C']=`
                <div style="text-align:center; margin-bottom:10px; color:#fff; font-weight:bold;">ÊâãÂäøÊéßÂà∂</div>
                <div class="tip-item"><span class="tip-key">‚úä Êè°Êã≥</span> Âú£ËØûÊ†ë</div>
                <div class="tip-item"><span class="tip-key">‚úã Âº†Êâã</span> ÊòüÊ≤≥Êï£ÂºÄ</div>
                <div class="tip-item"><span class="tip-key">üëå ÊçèÂêà</span> ÈîÅÂÆöÁÖßÁâá</div>
                
            `;document['\u0062\u006F\u0064\u0079']['\u0061\u0070\u0070\u0065\u006E\u0064\u0043\u0068\u0069\u006C\u0064'](_0x5252d);}async function init(){initThree();createMaterials();setupLights();createParticles();createSnow();setupPostProcessing();setupEvents();createTips();await initMediaPipe();document['\u0067\u0065\u0074\u0045\u006C\u0065\u006D\u0065\u006E\u0074\u0042\u0079\u0049\u0064']("redaol".split("").reverse().join(""))['\u0073\u0074\u0079\u006C\u0065']['\u006F\u0070\u0061\u0063\u0069\u0074\u0079']=478283^478283;setTimeout(()=>document['\u0067\u0065\u0074\u0045\u006C\u0065\u006D\u0065\u006E\u0074\u0042\u0079\u0049\u0064']("\u006C\u006F\u0061\u0064\u0065\u0072")['\u0072\u0065\u006D\u006F\u0076\u0065'](),469601^469313);animate();}init();
                
        </script>

</body>
</html>
